<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.darryring.dao.DrUserDao">
    <!--账号密码注册账号-->
    <insert id="insertUser">
        insert into dr_user(phone,password)value(#{phone},#{password})
    </insert>

    <!--短信注册账号-->
    <insert id="registByPhone">
        insert into dr_user(phone)value(#{phone})
    </insert>

    <!--根据手机号码和密码登录-->
    <select id="findByNamePw" resultType="DrUser">
        SELECT * FROM dr_user WHERE phone=#{phone} and password=#{password}
    </select>

    <!--个人中心修改资料-->
    <update id="updateUser">
        UPDATE `darryring`.`dr_user` SET `userName` = #{userName} , `loginName` = #{loginName} , `password` = #{password} ,
        `sex` = #{sex} ,`identityCode` = #{identityCode} , `email` = #{email} ,`touRoute` = #{touRoute},`loveWord` = #{loveWord} where`userId` = #{userId}
    </update>

    <!--根据用户ID查用户-->
    <select id="findAll" resultType="druser">
        select * from dr_user where userId=#{userId}
    </select>

    <!--根据手机号码判定用户是否存在-->
    <select id="findUserByPhone" resultType="DrUser">
        select * from dr_user where phone=#{phone}
    </select>

    <!--修改用户信息-->
    <update id="improve" parameterType="DrUser" keyProperty="userId" keyColumn="userId">UPDATE dr_user SET userName=#{userName},loginName=#{loginName},identityCode=#{identityCode},email=#{email},sex=#{sex},loveWord=#{loveWord}WHERE userId=#{userId} </update>

    <!--修改密码-->
    <update id="resetPwd" parameterType="DrUser">update dr_user set password = #{password} where userId = #{userId} </update>

    <!--修改密码前判断输入的原密码是否存在-->
    <select id="queryByPwd" resultType="DrUser">select userName from dr_user where password = #{password} and userId = #{userId} </select>

</mapper>